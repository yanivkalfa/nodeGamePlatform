<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="../css/style.css" type="text/css" media="all">
    <script type="text/javascript" src="../supers/utilities/Collection.js"></script>
    <script type="text/javascript" src="../supers/utilities/Point.js"></script>
    <script type="text/javascript" src="../supers/utilities/Vector.js"></script>
    <script type="text/javascript" src="../supers/utilities/Lists.js"></script>
    <script type="text/javascript" src="../supers/Attributes.js"></script>
    <script type="text/javascript" src="../supers/Moves.js"></script>
    <script type="text/javascript" src="../supers/Collision.js"></script>
    <script type="text/javascript" src="../supers/Renderer.js"></script>
    <script type="text/javascript" src="../supers/ScoreBoard.js"></script>
    <script type="text/javascript" src="../supers/KeyBinds.js"></script>
    <script type="text/javascript" src="../supers/Loader.js"></script>
    <script type="text/javascript" src="../supers/Entity.js"></script>
    <script type="text/javascript" src="../supers/Player.js"></script>
    <script type="text/javascript" src="../supers/Loop.js"></script>
    <script type="text/javascript" src="../supers/Ai.js"></script>
    <script type="text/javascript" src="../supers/OutRouter.js"></script>
    <script type="text/javascript" src="../supers/InRouter.js"></script>
    <script type="text/javascript" src="../supers/Roles.js"></script>
    <script type="text/javascript" src="../supers/Game.js"></script>

    <script type="text/javascript" src="pong.outRouter.js"></script>
    <script type="text/javascript" src="pong.inRouter.js"></script>
    <script type="text/javascript" src="pong.Roles.js"></script>
    <script type="text/javascript" src="pong.Attributes.js"></script>
    <script type="text/javascript" src="pong.ScoreBoard.js"></script>
    <script type="text/javascript" src="pong.Loader.js"></script>
    <script type="text/javascript" src="pong.Entity.js"></script>
    <script type="text/javascript" src="pong.Player.js"></script>
    <script type="text/javascript" src="pong.ball.js"></script>
    <script type="text/javascript" src="pong.Loop.js"></script>
    <script type="text/javascript" src="pong.Game.js"></script>

    <title>My second game</title>
</head>
<body>
<div id="page">
    <div id="gameCanvas"></div>
</div>

</body>
</html>
<script type="text/javascript">
    var Point = window.game.class.Point,
            Vector = window.game.class.Vector,
            keyup,
            keydown
            ,options = {
                canvas : {
                    node : document.getElementById('gameCanvas'),
                    width : 900,
                    height : 500
                },

                cycle : {
                    cycleEvery : 10
                }
            }
            ,pong
            ;
    pong = new window.game.class.PongGame(options);
    pong.init();
    console.log(pong);
    keyup = function(e){
        pong.keyup(e);
    };
    keydown = function(e){
        pong.keydown(e);
    };

    pong.bindKey = function(){
        document.addEventListener("keyup", keyup);
        document.addEventListener("keydown", keydown);
    };
    pong.unBindKey = function(){
        document.removeEventListener("keyup", keyup);
        document.removeEventListener("keydown", keydown);
    };

    pong.bindKey();


    var playerOps = {id:1231234234,  name : 'Mr.Shmelow', local:true};
    var pongPlayer = new window.game.class.PongPlayer(playerOps,pong);
    pongPlayer.init();
    pong.addPlayer(pongPlayer);


    playerOps = {id:1231234235,  name : 'player2', position:new Point((pong.canvas.width-40), (pong.canvas.height/2) - 50)};
    var pongPlayer2 = new window.game.class.PongPlayer(playerOps,pong);
    pongPlayer2.init();
    pong.addPlayer(pongPlayer2);

    var ball = new window.game.class.PongBall({id:1231234236},pong);
    ball.init();
    pong.addEntity(ball);

    function SnapShot (){
        this.i = 0;
        this.t = Date.now();
        this.u = [
            {id:1231234234, p:{x:0,y:0},s:0},
            {id:1231234235, p:{x:0,y:0},s:0},
            {id:1231234236, p:{x:0,y:0}}
        ]
    }

    var pOnePoint = {x:20,y:(pong.canvas.height/2) - 50};
    var pOnePointTwo = {x:20,y:300};
    var pOnePointTree = {x:(pong.canvas.width/2)-5,y:(pong.canvas.height/2)-5};
    var movDir = +2.5;
    var movDir2 = +2.5;
    var movDir3x = +3;
    var movDir3y = +2.5;
    var c = 0;

    var now,then = Date.now(), cycle;

    setInterval(function(){
        if(pongPlayer.position.y <= 0){
            movDir = +2.5;
        }

        if(pongPlayer.position.y >= pong.canvas.height-100){
            movDir = -2.5;
        }

        pongPlayer.position.y += movDir;

        //--------------------------------------------------------------


        if(pongPlayer2.position.y <= 0){
            movDir2 = +2.5;
        }

        if(pongPlayer2.position.y >= pong.canvas.height-100){
            movDir2 = -2.5;
        }
        pongPlayer2.position.y += movDir2;

        //--------------------------------------------------------------

        if(ball.position.y <= 0){
            movDir3y = +2.5;
        }

        if(ball.position.x <= 40){
            movDir3x = +3;
        }

        if(ball.position.y >= pong.canvas.height-10){
            movDir3y = -2.5;
        }

        if(ball.position.x >= pong.canvas.width-40){
            movDir3x = -3;
        }

        ball.position.x += movDir3x;
        ball.position.y += movDir3y;

    }, 0);


    setInterval(function(){
        var snapShot = new SnapShot();
        snapShot.i = c;
        snapShot.u[0].p.x = pongPlayer.position.x;
        snapShot.u[0].p.y = pongPlayer.position.y;
        snapShot.u[1].p.x = pongPlayer2.position.x;
        snapShot.u[1].p.y = pongPlayer2.position.y;
        snapShot.u[2].p.x = ball.position.x;
        snapShot.u[2].p.y = ball.position.y;
        pong.snapShots.add(snapShot);
        if(pong.snapShots.get().length > 60)pong.snapShots.get().shift();
        c++;
    }, 10);




    pong.load();
    pong.start();
</script>

